---
layout: post
title: Chaos Theory
date: 2021-02-04 15:06:00
description: When the present determines the future, but the approximate present does not approximately determine the future
tags: ["Science", "Mathematics", "Physics", "Chaos Theory", "Predictions"]

categories: sample-posts
citation: true
---

Chaos theory is a study about randomness and unpredictable behavior in a system that obeys deterministic laws, meaning that a particular initial condition always evolves in the same way. Chaos theory state that a small change in the initial conditions may lead to drastically different behavior. This is also known as the butterfly effect introduced by Edward Lorenz from the idea that the mere flapping of a butterfly’s wing can cause a hurricane several weeks later.

Edward Lorenz was a mathematician and meteorologist who combined the two disciplines to create chaos theory. During the 1950s, Edward Lorenz searched for a means of forecasting the weather. In an experiment to model a weather prediction, he makes the initial conditions to be 0.506, instead of 0.506127. The result was a different prediction. From this, he concluded that the weather must change on a dime. A small change in the initial conditions has immense long-term implications. It shows that even detailed atmospheric modeling cannot make precise long-term weather predictions because we never know the initial conditions precisely enough to accurately predict the weather after a certain point in time. That tiny decimal difference is enough to produce extremely inaccurate predictions in the long run.

# Conditions for Chaos
There are three required mathematical properties for a system to be classified as chaotic:
1. Sensitivity to initial conditions
1. Topological mixing
1. Density of periodic orbits

## Sensitivity to initial conditions
Sensitivity to initial conditions is popularly known as the butterfly effect. Edward Lorenz developed a simplified mathematical model for atmospheric convection. The model is a system of three ordinary differential equations known as the Lorenz equations:

$$
\frac{dx}{dt} = \sigma(y-x)
$$

$$
\frac{dy}{dt} = x(\rho-z) - y
$$

$$
\frac{dz}{dt} = xy - \beta z
$$

With:
1. x as the rate of convection
1. y as horizontal temperature variation
1. z as vertical temperature variation
1. sigma, rho, and beta are system constant parameters

<p align="center">
    <img width="100%" src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*MYUOIUo6IqfhtK1VAmOJSA.gif">
</p>
<!-- ![alt text](https://miro.medium.com/v2/resize:fit:720/format:webp/1*MYUOIUo6IqfhtK1VAmOJSA.gif) -->

The above graph used the Lorenz equation. The initial conditions for x and z were kept the same but those for y were changed between 1.001, 1.0001, and 1.00001. The values for rho, sigma, and beta were 45.92, 16, and 4 respectively.

As we can see from the graph, even the slightest difference in initial values of y causes significant changes after about 12 iterations in the three cases. This is an example of sensitive dependence on initial conditions. Systems that are sensitive to initial conditions are said to be chaotic but being only sensitive dependence on initial conditions is not enough. Consider a system generated by the map x → 1.5x.

<p align="center">
    <img width="100%" src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*NQuHmsW8RaBby-_MPkNK8g.gif">
</p>
<!-- ![alt text](https://miro.medium.com/v2/resize:fit:828/format:webp/1*NQuHmsW8RaBby-_MPkNK8g.gif) -->

With initial x = 0.2 and initial x =0.21. Notice that after several iterations the red and blue lines started to move on their own. This system is sensitive to initial conditions, but it is not chaotic. Since the system multiplies x by 1.5, any small difference between starting points is magnified by a factor of 1.5 at each iteration. Regardless of the starting condition, every starting condition will eventually approach positive or negative infinity, so the asymptotic behavior given a set of initial conditions is very predictable.

## Topological mixing 
Topological mixing means it will evolve in the same region for a certain period of time, then eventually intersect with any other given region.

<p align="center">
    <img width="100%" src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*PwOxIPknTl7n-1Ag15ckzw.gif">
</p>
<!-- ![alt text](https://miro.medium.com/v2/resize:fit:828/format:webp/1*PwOxIPknTl7n-1Ag15ckzw.gif) -->

The above graph shows six iterations of a set of states x and y passed through the logistic map. Light blue (first iteration) indicates the initial condition, which forms a circle. It can be seen that mixing occurs as time progresses. Dark blue (sixth iteration) shows that the points are almost completely scattered in the phase space.

This shows that two neighboring points in a complex system will eventually end up in very different positions after some iterations. The logistic map has an equation as follow:

$$x_{t+1}=rx_t(1-x_t)$$

To expand the state-space of the logistic map into two dimensions, a second state was created as follow:

$$y_{t+1}=x_t+y_t$$

## Density of Periodic Orbits
Density of Periodic Orbits means that each point in phase space is arbitrarily close to a set of initial conditions. The simplest example of systems with a density of periodic orbits is a one-dimensional logistic map defined by $x → 4 x (1 — x)$.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/887274b0597cc887661dd157f3ca93b2fbe8089c.gif">
</p>

The above graph shows 50 iterations of a logistic map defined by x → 2.1 x (1 — x). Notice that the orbit attracted to a certain value approximately around 0.5 as time progresses.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/9f647f6a661f0dbb3fcc48adb58c4b0d6abc8714.gif">
</p>

Now if we increase the r value to be 3.1 so that the logistic map is defined by x → 3.1 x (1 — x). Notice that the orbit turns into a period of 2 cycles since the value is cyclic around 0.7 and 0.5. It is called 2 cycles because it takes 2 iterations to complete one cycle.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/fdb00711f29b187995f24ed3bfb7ae761dd67f0c.gif">
</p>

Now if we increase the r value to be 3.5 so that the logistic map is defined by x → 3.5 x (1 — x), the orbit turns into a period of 4 cycles since the value is cyclic around 0.87, 0.38, 0.82, and 0.5. As before this behavior is stable because the system is cycling around 4 values and will eventually converge to those values as time progresses.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/42d1099da345a2b50312f501d097bb8f42026ba3.gif">
</p>

Now if we increase the r value to be 4. Notice that there is no periodic behavior anymore. The orbit never repeats exactly the same. This behavior is unstable because the orbit keeps cycling around irregularly. Hence logistic map defined by x → 4 x (1 — x) is considered chaotic because the orbit comes arbitrarily close to the initial point but fails to ever converge to a periodic orbit.

# Strange Attractor
Recall the logistic map we have talked about. It is actually a function defined by:

$$x_{t+1}=rx_t(1-x_t)$$

Map is just another way of saying a function. As we have seen previously, this function produces chaos at certain r parameter.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/af8dc257185243c5d8bbb4e29df551c36ec85e0f.gif">
</p>

The above graph shows an initial condition of 0.2 for several values of r. The green line obtained with an r value of 0.5, eventually converges to 0 as time progresses. Similar behavior happens to the blue, black, purple, and brown line, they converge to a certain value.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/2ce7cb2b6082b6b942116f76c074b97ae9d72639.gif">
</p>

Even if we change the initial x of the blue line to be 0.9, yet it still converges toward a certain value as time progresses. Such a value is called an attractor.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/fd7cacc84f0cbeb93f2b3401689f892dddf0f6a2.gif">
</p>

The orange line that has an r value of 3.5, the system oscillates between four values and eventually converges toward those values. This attractor is called a limit cycle.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/be6f657a6e52e3e293ca4241202c4a599070969d.gif">
</p>

The red line with an r value of 4.0 produces chaotic behavior as we previously mentioned. This system has a strange attractor, around which the system oscillates forever, never repeating itself exactly the same. In the above example, x turns to 0.611 after 50 iterations. A state at the final iteration is called the final state.

# Bifurcation
Those graphs we have previously seen show how x changes overtime given different r values, but we have only seen r of 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, and 4.0. In order to explore further, we will create a bifurcation diagram. Bifurcation is just another term for splitting into two. The x-axis is r value from 0.0 to 4.0 while the y-axis is x at the final state of each r.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/456b5a28e314fc813ccf30a630886501574ecbb2.webp">
</p>

The above graph shows the splitting of the periods of stable orbits from 1 to 2 to 4 to 8 to 16 to 32 etc. If we look closer to the interval of r between 2.7 to 3.3 it shows:

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/2e4f4b061b96db0dbf1da90fa965eacc31f0fc30.webp">
</p>

Notice that the splitting happens when r approaches 3.0. Recall the colorful graphs we have talked about before, this is actually the gray line that has 2 periods.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/f8aa9033cd344b1f8ad3cfb7aea1c6f272ae4189.webp">
</p>

Now we look closer to r between 3.35 to 3.525, another split happens around r value of 3.449. Hence the orange line from our previous graph has a period of 4.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/eb4d88871f693cebfefa320c2a10b20212b81a0f.webp">
</p>

Zoom even more and now we see another split happens around r value of 3.544. Notice the period pattern? from 2 to 4 and now 8 periods, this is called period-doubling. By picking a certain value of r we can get any period we want as long as it is the power of two because it doubled every time. If we zoom to the next branch we will see a period of 16 and then it keeps doubling as we increase r value. Doesn’t matter how much we zoom we will see the same pattern, again and again, hence it is considered as a fractal. Unfortunately, our graph has low quality and can not shows it clearly.

# The Feigenbaum Constants
Recall the bifurcation diagram we have created previously. The splitting points are not evenly spaced, instead, they are getting smaller and smaller as r increases.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/26dd1e80d529ca8036d8c1fbb7d7fe2b2041f819.webp">
</p>

The height and width of the pitchforks are decreasing at a constant ratio. The ratio of ∆1 to ∆2 is about the same as ∆2 to ∆3. That ratio approaches the value of 4.669, which means that the ratio of ∆1 over ∆2 is close to 4.669 and ∆2 over ∆3 is even closer to 4.669, and so on. Feigenbaum proved the ratio and it is named after his name, Feigenbaum constant. What interesting is the Feigenbaum constant is universal, means that it has the same value for all function f(x) that map an interval to itself and have a single quadratic maximum. The Feigenbaum constant turns out to be a very important constant in mathematics. It is analogous to π in geometry and e in calculus.


# Mandelbrot Set
<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/004932ce3b94e33e0a3b441d8f95af994d0b5bdd.gif">
</p>

The Mandelbrot Set is one of the most beautiful fractals in mathematics. It is the set of values of c in the complex plane for which the orbit of 0 under iteration of the quadratic map remains bounded.

$$
z_{t+1}={z_t}^2 + c
$$

With initial z = 0, a complex number c is part of the Mandelbrot set if the value of z_t remains bounded regardless of how much we iterate the function. If the number blows up to infinity it means that c is not a part of the Mandelbrot set.

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/5b28985e165870fec7e73e647de799b91ecacc21.webp">
</p>

The above graph shows the value of the Mandelbrot set, the black region indicates that c is part of the Mandelbrot set.

$$
1 = 0^2 + 1
$$

$$
2 = 1^2 + 1
$$

$$
5 = 2^2 + 1
$$

$$
26 = 5^2 + 1
$$

$$
677 = 26^2 + 1
$$

For example, c = 1 on the right corner of the graph is not part of the Mandelbrot set, because it will blows up to infinity as time progresses.

$$
-1 = 0^2 + (-1)
$$

$$
0 = -1^2 + (-1)
$$

$$
-1 = 0^2 + (-1)
$$

$$
0 = -1^2 + (-1)
$$

$$
-1 = 0^2 + (-1)
$$

Contrary to that, -1 is in the black region, which means that it is a part of the Mandelbrot set, it oscillates between 2 values -1 and 0. But, What it has to do with chaos?

<p align="center">
    <img width="100%" src="https://archive.ph/M2N5r/996acc9ef0cb35604a5a179d30df98654a09baa1.gif">
</p>

Bifurcation is actually sitting there underneath the Mandelbrot set. All the number in the main cardioid (that biggest circle) is converging to a certain value, this is analogous to that r value between 0 to 3 in bifurcation. All the numbers in the main disk are oscillating between 2 values, this is analogous to that r value between 3 to 3.44 in bifurcation, they have a period of 2. The period-doubling keeps going on as we lower the c and will eventually hit chaos just like we increase r in bifurcation.

# Conclusion
Every decision you have made in your entire life has led you to read this article.